"use strict";var AREADATA=[{name:"福建省",id:"111",children:[{name:"厦门市",id:"222",children:[{name:"湖里区",id:"333",children:[{name:"金山街道",id:"444"}]}]}]},{name:"浙江省",id:"123",children:[{name:"杭州市",id:"234",children:[{name:"余杭区",id:"345",children:[{name:"萧山街道",id:"456"}]}]}]}],cyui={City:function(t){var e=this;this.trigger=document.querySelector(t.trigger||t),this.type=t.type||"area",this.data=t.data||AREADATA,this.title=t.title||"请选择所在地区",this.value=[],this.level=4,this.clientW=document.querySelector("body").clientWidth,this.showNum=1,this.touch={touchX:!1,touchY:!1},this.trigger.addEventListener("click",function(){return e.init()})}};cyui.City.prototype={init:function(){document.querySelector(".cyui-cascade-dialog")||(this.getLevel(this.data[0]),this.createContainerNode(),this.createCascadeSelectNode(),this.insertDataNode(),this.initEvent(),this.showContainer())},getLevel:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,t=t||this.data;if(t.children)return e+=1,this.getLevel(t.children[0],e);this.level=e},createContainerNode:function(){var t=document.createElement("div");t.classList.add("cyui-cascade-dialog"),t.innerHTML="\n            <div class='cyui-common-overlay'></div>\n            <div class='cyui-cascade-box'>\n                <div class='cyui-common-head'>\n                    <h3 class='cyui-common-title'>".concat(this.title,"</h3>\n                    <div class='cyui-common-close'></div>\n                </div>\n                <div class='cyui-cascade-select'></div>\n                <div class='cyui-cascade-card'>\n                    <div class='cyui-cascade-content'>\n                        ").concat(Array(this.level).fill("<ul class='cyui-cascade-item'></ul>").join(""),"\n                    </div>\n                </div>\n            </div>\n            "),document.querySelector("body").appendChild(t)},createCascadeSelectNode:function(){for(var t=0;t<this.showNum;t++){var e=document.createElement("span");e.setAttribute("data-index",t),e.setAttribute("data-label","请选择"),e.innerHTML="请选择",t==this.showNum-1&&e.classList.add("on"),document.querySelector(".cyui-cascade-select").appendChild(e)}},insertDataNode:function(t){var c=this;(t||this.data).forEach(function(t){var e=document.createElement("li");e.setAttribute("data-name",t.name),e.setAttribute("data-id",t.id),e.innerHTML=t.name,null!==(t=document.querySelectorAll(".cyui-cascade-item")[c.showNum-1])&&void 0!==t&&t.appendChild(e)})},initEvent:function(){var t,e=this;null!==(t=document.querySelector(".cyui-cascade-close"))&&void 0!==t&&t.addEventListener("click",function(){return e.hideContainer()}),null!==(t=document.querySelector(".cyui-cascade-card"))&&void 0!==t&&t.addEventListener("touchstart",function(t){return e.touchStart(t)}),null!==(t=document.querySelector(".cyui-cascade-card"))&&void 0!==t&&t.addEventListener("touchend",function(t){return e.touchEnd(t)}),null!==(t=document.querySelector(".cyui-cascade-card"))&&void 0!==t&&t.addEventListener("touchmove",function(t){return e.touchMove(t)}),null!==(t=document.querySelector(".cyui-cascade-card"))&&void 0!==t&&t.addEventListener("click",function(t){return e.clickItem(t)})},findChildren:function(t,e){for(var c=e||this.data,i=null,n=0;n<c.length;n++){var a=c[n];if(a.id===t){i=a.children;break}null===i&&a.children&&(i=this.findChildren(t,a.children))}return i},clickItem:function(t){"LI"==t.target.nodeName&&(t.target.classList.add("on"),this.value[this.showNum-1]={name:t.target.dataset.name,id:t.target.dataset.id},this.updateSelectNodeText(),this.showNum>=this.level||this.next(t.target.dataset.id))},clickNavItem:function(t){},next:function(t){this.showNum+=1,this.insertDataNode(this.findChildren(t)),this.createNextSelectNode(),this.moveBox(),this.updateSelectNodeLine()},updateSelectNodeText:function(){document.querySelector(".cyui-cascade-select").innerHTML="";for(var t=0;t<this.value.length;t++){var e,c=document.createElement("span");c.setAttribute("data-label",null===(e=this.value[t])||void 0===e?void 0:e.name),c.innerHTML=null===(e=this.value[t])||void 0===e?void 0:e.name,this.showNum-1==t&&c.classList.add("on"),document.querySelector(".cyui-cascade-select").appendChild(c)}},updateSelectNodeLine:function(){var t=document.querySelectorAll(".cyui-cascade-select span");console.log(t,"123",this.showNum),t.forEach(function(t){return t.classList.remove("on")}),t[this.showNum-1].classList.add("on")},createNextSelectNode:function(){var t=document.createElement("span");t.setAttribute("data-label","请选择"),t.innerHTML="请选择",t.classList.add("on"),document.querySelector(".cyui-cascade-select").appendChild(t)},moveBox:function(){document.querySelector(".cyui-cascade-content").style.transform="translateX(-".concat(this.showNum-1,"00%)")},showContainer:function(){document.querySelector(".cyui-cascade-dialog").classList.add("on"),document.querySelector(".cyui-cascade-box").classList.add("on")},hideContainer:function(){document.querySelector(".cyui-cascade-dialog").classList.remove("on"),document.querySelector(".cyui-cascade-box").classList.remove("on")},touchStart:function(t){this.touch.startX=t.touches[0].pageX,this.touch.startY=t.touches[0].pageY,this.touch.startTime=+new Date},touchEnd:function(t){var e=+new Date,c=t.changedTouches[0].pageX,t=this.touch.startX-c,c=0<=t?1:-1;if(Math.abs(t)<this.clientW/3){if(Math.abs(t)<30)return;if(300<e-this.touch.startTime)return}this.showNum+=c,this.moveBox(),this.touch.touchY=!1},touchMove:function(t){this.touch.touchY||(this.touch.moveY=t.touches[0].clientY-this.touch.startY,this.touch.moveX=t.touches[0].clientX-this.touch.startX,console.log("Y:",Math.abs(this.touch.moveY),"   X: ",Math.abs(this.touch.moveX),this.touch.touchY),Math.abs(this.touch.moveY)>Math.abs(this.touch.moveX)-8?this.touch.touchY=!0:(this.touch.touchX=!0,t.preventDefault(),t.stopPropagation()))}};